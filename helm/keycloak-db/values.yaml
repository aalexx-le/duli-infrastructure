# Keycloak Dedicated PostgreSQL Cluster Configuration
# Uses CloudNativePG operator

cluster:
  enabled: true
  # Overridden per environment (keycloak-db-staging, keycloak-db-prod)
  name: keycloak-db
  
  # PostgreSQL version
  imageName: ghcr.io/cloudnative-pg/postgresql:17-standard-bookworm
  
  # Single instance for staging, increase for production
  instances: 1
  
  # Credentials secret (overridden per environment)
  credentials:
    secretName: keycloak-db-credentials
  
  # Bootstrap configuration
  bootstrap:
    initdb:
      database: keycloak
      owner: keycloak
  
  # PostgreSQL parameters optimized for Keycloak
  postgresql:
    parameters:
      max_connections: "100"
      shared_buffers: "128MB"
      effective_cache_size: "256MB"
      work_mem: "8MB"
      maintenance_work_mem: "32MB"
  
  # Service configuration
  service:
    type: ClusterIP
