# ============================================================================
# {{ target_namespace | upper }} ENVIRONMENT - CONNECTION INFORMATION
# ============================================================================
# Generated: {{ ansible_date_time.iso8601 }}
#
# All services accessible via domain names
# ============================================================================

[environment]
namespace = {{ target_namespace }}
{% if target_namespace == 'prod' %}
domain_suffix = duli.one
{% else %}
domain_suffix = staging.duli.one
{% endif %}

# ============================================================================
# APPLICATION SERVICES (HTTPS)
# ============================================================================

[backend]
url = https://api.{% if target_namespace == 'staging' %}staging.{% endif %}duli.one

[ai-service]
url = https://ai.{% if target_namespace == 'staging' %}staging.{% endif %}duli.one

[scheduler]
url = https://n8n.{% if target_namespace == 'staging' %}staging.{% endif %}duli.one

[keycloak]
url = https://auth.{% if target_namespace == 'staging' %}staging.{% endif %}duli.one

# ============================================================================
# INFRASTRUCTURE SERVICES
# ============================================================================

[postgresql]
domain = {% if target_namespace == 'staging' %}db.staging.duli.one{% else %}db.duli.one{% endif %}
port = 5432
username = {{ postgres_user }}
password = {{ postgres_pass }}
database = app
connection_url = postgresql://{{ postgres_user }}:{{ postgres_pass }}@{% if target_namespace == 'staging' %}db.staging.duli.one{% else %}db.duli.one{% endif %}:5432/app

[redis]
domain = {% if target_namespace == 'staging' %}redis.staging.duli.one{% else %}redis.duli.one{% endif %}

port = 6379
password = {{ redis_password }}
connection_url = redis://:{{ redis_password }}@{% if target_namespace == 'staging' %}redis.staging.duli.one{% else %}redis.duli.one{% endif %}

[rabbitmq]
amqp_domain = {% if target_namespace == 'staging' %}mq.staging.duli.one{% else %}mq.duli.one{% endif %}

amqp_port = 5672
username = {{ rabbitmq_user }}
password = {{ rabbitmq_pass }}
management_url = https://queue.{% if target_namespace == 'staging' %}staging.{% endif %}duli.one
connection_url = amqp://{{ rabbitmq_user }}:{{ rabbitmq_pass }}@{% if target_namespace == 'staging' %}mq.staging.duli.one{% else %}mq.duli.one{% endif %}:5672

# ============================================================================
# GITOPS TOOLS
# ============================================================================

[argocd]
url = https://argocd.duli.one

[rancher]
url = https://rancher.duli.one

# ============================================================================
# USAGE EXAMPLES
# ============================================================================
#
# PostgreSQL:
#   psql -h {{ 'db.staging.duli.one' if target_namespace == 'staging' else 'db.duli.one' }} -p 5432 -U {{ postgres_user }} -d app
#
# Redis:
#   redis-cli -h {{ 'redis.staging.duli.one' if target_namespace == 'staging' else 'redis.duli.one' }} -p 6379 -a <password>
#
# RabbitMQ AMQP:
#   amqp://{{ rabbitmq_user }}:<password>@{{ 'mq.staging.duli.one' if target_namespace == 'staging' else 'mq.duli.one' }}:5672
#
# RabbitMQ Management UI:
#   https://queue.{% if target_namespace == 'staging' %}staging.{% endif %}duli.one
#
# ============================================================================

